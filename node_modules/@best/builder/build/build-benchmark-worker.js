"use strict";
/*
 * Copyright (c) 2019, salesforce.com, inc.
 * All rights reserved.
 * SPDX-License-Identifier: MIT
 * For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/MIT
 */
Object.defineProperty(exports, "__esModule", { value: true });
const build_benchmark_1 = require("./build-benchmark");
const send = process.send && process.send.bind(process);
if (!send) {
    throw new Error('This module must be used as a forked child');
}
const messagerAdapter = {
    onBenchmarkBuildStart(benchmarkPath) {
        send({
            type: 'messager.onBenchmarkBuildStart',
            benchmarkPath,
        });
    },
    log(message) {
        send({
            type: 'messager.log',
            message,
        });
    },
    onBenchmarkBuildEnd(benchmarkPath) {
        send({
            type: 'messager.onBenchmarkBuildEnd',
            benchmarkPath,
        });
    },
};
module.exports = async function (input, callback) {
    const result = await (0, build_benchmark_1.buildBenchmark)(input.benchmark, input.projectConfig, input.globalConfig, messagerAdapter);
    callback(null, result);
};
//# sourceMappingURL=build-benchmark-worker.js.map