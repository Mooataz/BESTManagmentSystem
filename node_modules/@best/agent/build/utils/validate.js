"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateConfig = validateConfig;
const utils_1 = require("@best/utils");
function validateToken(token, requiredToken) {
    return requiredToken ? requiredToken === token : true;
}
function validateSpecs(specs, agentSpecs = []) {
    return specs ? (0, utils_1.matchSpecs)(specs, agentSpecs) : true;
}
function validateJobs(jobs) {
    return jobs > 0;
}
function validateConfig(config, agentConfig, runnerSpecs, socketId) {
    if (!validateToken(config.authToken, agentConfig.authToken)) {
        console.log(`[AGENT] Rejecting client (${socketId}): Token missmatch`);
        return `Unable to match token`;
    }
    if (!validateSpecs(config.specs, runnerSpecs)) {
        console.log(`[AGENT] Rejecting client (${socketId}): Invalid specs ${JSON.stringify(config.specs)}`);
        return `Unable to match specs.`;
    }
    if (!validateJobs(config.jobs)) {
        console.log(`[AGENT] Rejecting client (${socketId}): No jobs specified`);
        return `Client must specify number of jobs in advance.`;
    }
}
//# sourceMappingURL=validate.js.map